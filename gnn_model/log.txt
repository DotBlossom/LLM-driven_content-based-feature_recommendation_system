 
Device selected: cuda
Processing raw data from D:\trainDataset\localprops\transactions_train_filtered.json...
C:\Users\candyform\Desktop\inferenceCode\gnn_cl_noise.py:41: FutureWarning: factorize with argument that is not not a Series, Index, ExtensionArray, or np.ndarray is deprecated and will raise in a future version.
  user_ids, user_uniques = pd.factorize(customers)
C:\Users\candyform\Desktop\inferenceCode\gnn_cl_noise.py:42: FutureWarning: factorize with argument that is not not a Series, Index, ExtensionArray, or np.ndarray is deprecated and will raise in a future version.
  item_ids, item_uniques = pd.factorize(articles)
Preprocessing Done. Users: 1307677, Items: 65633, Interactions: 24018003
Generating Sparse Graph on GPU...

Start Lightweight Training on cuda...
Config: Dim=16, Layers=2, Batch=16384, CL_Interval=50
Epoch 1/3: 100%|██████████████████████| 1465/1465 [26:30<00:00,  1.09s/it, loss=0.2635, avg=0.4112] 
Epoch 1 Finished
Epoch 2/3: 100%|██████████████████████| 1465/1465 [26:03<00:00,  1.07s/it, loss=0.2283, avg=0.3039] 
Epoch 2 Finished
Epoch 3/3: 100%|██████████████████████| 1465/1465 [26:42<00:00,  1.09s/it, loss=0.1930, avg=0.2644] 
Epoch 3 Finished
Saving Lightweight Model...
Running Inference Test...
Recommendation for User: 00007d2de826758b65a93dd24ce629ed66842531df6699338c5570910a014cc2
Items: ['0532578010', '0446224002', '0539723005', '0355072002', '0562245001']

[Cache Hit] Loading graph data from D:\trainDataset\localprops\cache\processed_graph_train.pt...
Generating Sparse Graph Adjacency Matrix...

[Training Start] Users: 962521, Items: 47062
Epoch 1/10: 100%|█████████████████████████████| 1099/1099 [17:50<00:00,  1.03it/s, loss=3.4370, avg=1.3440] 
Epoch 2/10: 100%|█████████████████████████████| 1099/1099 [17:45<00:00,  1.03it/s, loss=3.3908, avg=1.2343] 
Epoch 3/10: 100%|█████████████████████████████| 1099/1099 [17:45<00:00,  1.03it/s, loss=3.4106, avg=1.2279] 
Epoch 4/10: 100%|█████████████████████████████| 1099/1099 [17:41<00:00,  1.03it/s, loss=3.3507, avg=1.2232] 
Epoch 5/10: 100%|█████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.3149, avg=1.2188] 
Epoch 6/10: 100%|█████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.2906, avg=1.2141] 
Epoch 7/10: 100%|█████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.2664, avg=1.2083] 
Epoch 8/10: 100%|█████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.2357, avg=1.2025] 
Epoch 9/10: 100%|█████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.2358, avg=1.1984] 
Epoch 10/10: 100%|████████████████████████████| 1099/1099 [17:36<00:00,  1.04it/s, loss=3.2267, avg